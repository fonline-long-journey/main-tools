{
  "$type": "Screen",
  "IsModal": true,
  "IsMultiinstance": false,
  "IsCloseOnMiss": false,
  "AvailableCursors": null,
  "IsCanMove": true,
  "IsMoveIgnoreBorders": false,
  "BackgroundImage": null,
  "BackgroundImageLayout": "None",
  "Expanded": true,
  "Selected": false,
  "Active": true,
  "Name": "Screen",
  "Position": "0, 0",
  "Size": "0, 0",
  "Anchor": "None",
  "Dock": "Fill",
  "IsDraggable": false,
  "IsNotHittable": true,
  "CheckTransparentOnHit": false,
  "GlobalScope": "string@ FormatXXX( int value )\r\n{\r\n    string@ result = \"\";\r\n    result = \"\" + ABS(value);\r\n    if(result.length() < 2) result = \"0\" + result;\r\n    if(result.length() < 3) result = \"0\" + result;\r\n    if( value < 0 ) result = \"-\" + result;\r\n    return result;\r\n    /*int offs  = 0;\r\n    if( value >= 0 )\r\n    {\r\n        result += EncodeUTF8( '9' + 4 );\r\n    }\r\n    else\r\n    {\r\n        offs = 0x20;\r\n        result += EncodeUTF8( '9' + offs + 3 );\r\n        value = -value;\r\n    }\r\n\r\n    value = CLAMP( value, 0, 999 );\r\n\r\n    result += EncodeUTF8( '0' + offs + value / 100 );\r\n    result += EncodeUTF8( '0' + offs + value / 10 % 10 );\r\n    result += EncodeUTF8( '0' + offs + value % 10 );\r\n\r\n    return result;*/\r\n}\r\n",
  "ClassFields": "bool isHitIfaceOnMouseDown;",
  "OnInit": "SetSize(__ScreenWidth, __ScreenHeight);",
  "OnShow": null,
  "OnHide": null,
  "OnAppear": null,
  "OnDisappear": null,
  "OnDraw": "",
  "OnMove": null,
  "OnMouseDown": "",
  "OnMouseUp": "",
  "OnMousePressed": null,
  "OnLMousePressed": null,
  "OnRMousePressed": null,
  "OnMouseClick": "",
  "OnLMouseClick": null,
  "OnRMouseClick": null,
  "OnMouseMove": null,
  "OnGlobalMouseDown": "if( __MapZooming && __SpritesZoomMin != __SpritesZoomMax )\r\n{\r\n    if( button == MOUSE_BUTTON_WHEEL_UP )\r\n        ChangeZoom( __SpritesZoom - 0.01 );\r\n    else if( button == MOUSE_BUTTON_WHEEL_DOWN )\r\n        ChangeZoom( __SpritesZoom + 0.01 );\r\n    else if( button == MOUSE_BUTTON_MIDDLE )\r\n        ChangeZoom( 1.0 );\r\n}\r\n\r\nif( GetChild( 0 ).FindMouseHit() is null )\r\n{\r\n    if( button == MOUSE_BUTTON_LEFT )\r\n        CustomCall( \"GameLMouseDown\" );\r\n    else if( button == MOUSE_BUTTON_RIGHT )\r\n        isHitIfaceOnMouseDown = ( FindMouseHit() !is null );\r\n}",
  "OnGlobalMouseUp": "if( GetChild( 0 ).FindMouseHit() is null )\r\n{\r\n    if( button == MOUSE_BUTTON_LEFT )\r\n        CustomCall( \"GameLMouseUp\" );\r\n    else if( button == MOUSE_BUTTON_RIGHT && !isHitIfaceOnMouseDown )\r\n        NextCursor();\r\n}",
  "OnGlobalMousePressed": null,
  "OnGlobalMouseClick": "",
  "OnGlobalMouseMove": "CustomCall( \"ProcessMouseScroll\" );",
  "OnInput": null,
  "OnGlobalInput": "",
  "OnActiveChanged": null,
  "OnFocusChanged": null,
  "OnHoverChanged": null,
  "OnDragChanged": null,
  "OnResizeGrid": null,
  "OnDrawItem": null,
  "Children": [
    {
      "$type": "Panel",
      "BackgroundImage": "art/intrface/iface_tlj_main.png",
      "BackgroundImageLayout": "None",
      "Expanded": true,
      "Selected": false,
      "Active": true,
      "Name": "Main",
      "Position": "-1, 314",
      "Size": "1024, 101",
      "Anchor": "None",
      "Dock": "None",
      "IsDraggable": false,
      "IsNotHittable": false,
      "CheckTransparentOnHit": true,
      "GlobalScope": null,
      "ClassFields": "",
      "OnInit": "//SetSize(1024, 101);\r\nSetPosition((__ScreenWidth - get_Width()) / 2, __ScreenHeight - _BaseHeight);\r\n//Log(\"Pyromother!\" + get_Parent().get_Width() + \"\" + get_Parent().get_Height());",
      "OnShow": "",
      "OnHide": null,
      "OnAppear": null,
      "OnDisappear": null,
      "OnDraw": null,
      "OnMove": null,
      "OnMouseDown": null,
      "OnMouseUp": null,
      "OnMousePressed": null,
      "OnLMousePressed": null,
      "OnRMousePressed": null,
      "OnMouseClick": null,
      "OnLMouseClick": null,
      "OnRMouseClick": null,
      "OnMouseMove": null,
      "OnGlobalMouseDown": null,
      "OnGlobalMouseUp": null,
      "OnGlobalMousePressed": null,
      "OnGlobalMouseClick": null,
      "OnGlobalMouseMove": null,
      "OnInput": null,
      "OnGlobalInput": null,
      "OnActiveChanged": null,
      "OnFocusChanged": null,
      "OnHoverChanged": null,
      "OnDragChanged": null,
      "OnResizeGrid": null,
      "OnDrawItem": null,
      "Children": [
        {
          "$type": "Panel",
          "BackgroundImage": "art/intrface/chatbox_top.png",
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "MessageBoxExtended",
          "Position": "0, -21",
          "Size": "300, 25",
          "Anchor": "Bottom",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "uint custom_height = 0;",
          "OnInit": "",
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "if( get_Height() != custom_height){\r\n    custom_height      =  get_Height();\r\n    uint spacerHeight = custom_height-25;\r\n    MessageBoxSpacer@ spacer = cast<MessageBoxSpacer>(Find(\"MessageBoxSpacer\"));\r\n    spacer.SetSize(300,spacerHeight>0?spacerHeight:0); \r\n}",
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": "art/intrface/chatbox_middle.png",
              "BackgroundImageLayout": "Tile",
              "Expanded": false,
              "Selected": false,
              "Active": true,
              "Name": "MessageBoxSpacer",
              "Position": "0, 24",
              "Size": "300, 0",
              "Anchor": "Bottom, Left, Right",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "MessageBox",
          "InvertMessages": null,
          "DisplayedMessages": null,
          "Text": null,
          "DynamicText": null,
          "Font": null,
          "VerticalAlignment": "Near",
          "HorisontalAlignment": "Near",
          "Align": false,
          "NoColorize": false,
          "Bordered": false,
          "DrawFromBottom": false,
          "NormalColor": null,
          "FocusedColor": null,
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "MessageBoxText",
          "Position": "9, -12",
          "Size": "280, 90",
          "Anchor": "Top, Bottom, Left, Right",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "void FiltersChanged()\r\n{\r\n    int[] messageTypes;\r\n    if( cast< GUICheckBox >( Parent.Find( \"Filter1\" ) ).IsChecked )\r\n        messageTypes.insertLast( FOMB_TALK );\r\n    if( cast< GUICheckBox >( Parent.Find( \"Filter2\" ) ).IsChecked )\r\n        messageTypes.insertLast( FOMB_COMBAT_RESULT );\r\n\r\n    if( messageTypes.length() == 0 )\r\n        messageTypes.insertLast( FOMB_ALL );\r\n\r\n    SetDisplayedMessages( messageTypes );\r\n}",
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/yellowDot.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "SeizeMessageBox",
          "Position": "253, 88",
          "Size": "16, 12",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": "MessageBoxExtended@ messageBoxExtended = cast<MessageBoxExtended>(Parent.Find(\"MessageBoxExtended\"));\r\nGUIObject@ messageBoxText = Parent.Find( \"MessageBoxText\" );\r\n\r\nint hmod = 0;\r\nswitch(button){\r\n  case MOUSE_BUTTON_WHEEL_UP:\r\n  case 0:\r\n    SetBackgroundImage(\"art/intrface/yellowDot.png\");\r\n    hmod = 5;\r\n    break;\r\n  case MOUSE_BUTTON_WHEEL_DOWN:\r\n  case 1:\r\n    SetBackgroundImage(\"art/intrface/whiteDot.png\");\r\n    hmod = -5;\r\n    break;\r\n}\r\n\r\nif(\r\n    hmod == 0 ||\r\n    // Высота увеличивается, позиция уменьшается\r\n    (hmod > 0 && messageBoxText.get_Height() < 800) ||\r\n    // Высота уменьшается, позиция увеличивается, >= 25h\r\n    (hmod < 0 && messageBoxText.get_Height() > 100 )\r\n){\r\n    // @@todo пересобрать черную магию в нормальный вид\r\n    messageBoxExtended.SetSize(messageBoxExtended.get_Width(),messageBoxExtended.get_Height() + hmod);\r\n    messageBoxExtended.SetPosition(0,4-messageBoxExtended.get_Height() );\r\n    messageBoxText.SetPosition(9,8-messageBoxExtended.get_Height());\r\n    messageBoxText.SetSize(280,70+messageBoxExtended.get_Height());\r\n} \r\n        ",
          "OnLMousePressed": "",
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": "SetBackgroundImage(null,IMAGE_LAYOUT_ZOOM);",
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Panel",
          "BackgroundImage": "",
          "BackgroundImageLayout": "Stretch",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "Console",
          "Position": "305, -52",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": "",
              "BackgroundImageLayout": "Stretch",
              "Expanded": true,
              "Selected": false,
              "Active": false,
              "Name": "ConsoleImage",
              "Position": "1, 7",
              "Size": "655, 38",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": true,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": [
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/console_top.png",
                  "BackgroundImageLayout": "Stretch",
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "ConsoleImageTop",
                  "Position": "0, 0",
                  "Size": "655, 18",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": true,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                },
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/console_middle_655.png",
                  "BackgroundImageLayout": "Tile",
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "ConsoleImageMiddle",
                  "Position": "0, 18",
                  "Size": "655, 1",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": true,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                },
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/console_bottom.png",
                  "BackgroundImageLayout": "Stretch",
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "ConsoleImageBottom",
                  "Position": "0, 19",
                  "Size": "655, 18",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": true,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                }
              ]
            },
            {
              "$type": "Console",
              "HistoryStorageName": "",
              "HistoryMaxLength": null,
              "InputLength": null,
              "Password": false,
              "Text": null,
              "DynamicText": null,
              "Font": null,
              "VerticalAlignment": "Center",
              "HorisontalAlignment": "Near",
              "Align": false,
              "NoColorize": false,
              "Bordered": false,
              "DrawFromBottom": false,
              "NormalColor": null,
              "FocusedColor": null,
              "Expanded": false,
              "Selected": false,
              "Active": false,
              "Name": "ConsoleText",
              "Position": "13, 13",
              "Size": "630, 25",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": "",
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": "uint rowHeight      = 13;\r\nuint requiredHeight = floor(_Text.length() / 78)*rowHeight+26;\r\nuint height         = get_Height();\r\n\r\nConsoleImage@ image = cast<ConsoleImage>(Parent.Find(\"ConsoleImage\"));\r\n\r\n// Выше 233 - сообщение будет выглядеть обрезано над головой персонажа, хотя полностью видно в чате\r\n/*if(_Text.length() == 200){\r\n    Message(\"Вам хочется перевести дыхание.\");\r\n}*/\r\n\r\n// В районе 400х - сервак забанит клиент за превышение лимита данных\r\n// (кириллица - юникод, для нее - лимит в районе 224)\r\n// Ограничение на ввод\r\n/*if(_Text.length() > 225){\r\n    _Text        = substring(_Text,0,390);\r\n    _CarriagePos = 390;\r\n}*/\r\n// Авторазделение сообщений \r\nif(_Text.length() > 210){ // @@todo проблемы с эмоутами-криком-шепотом\r\n    _Text += \"...\"; //@@todo понять почему не работает\r\n    _CarriagePos += 3;\r\n    SendText();\r\n    _Text        = \"...\";\r\n    _CarriagePos = 3;\r\n}\r\n\r\n// Автосайз окна ввода\r\nif(requiredHeight != height ) {\r\n    SetSize(get_Width(),requiredHeight);\r\n    image.SetSize(image.get_Width(),requiredHeight + 10);\r\n    image.Find(\"ConsoleImageBottom\").SetPosition(0,image.get_Height()-18);\r\n    image.Find(\"ConsoleImageMiddle\").SetSize(image.get_Width(),image.get_Height()-36);\r\n    Parent.SetPosition(Parent.get_PosX(), -49+16+rowHeight-requiredHeight);\r\n}",
              "OnGlobalInput": null,
              "OnActiveChanged": "Parent.Find( \"ConsoleImage\" ).SetActive( ActiveSelf ); ",
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "CheckBox",
          "IsChecked": null,
          "OnCheckedChanged": "cast< MessageBoxText >( Parent.Find( \"MessageBoxText\" ) ).FiltersChanged();",
          "IsDisabled": false,
          "PressedImage": "art/intrface/greenDot.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Filter1",
          "Position": "252, 100",
          "Size": "16, 12",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "CheckBox",
          "IsChecked": null,
          "OnCheckedChanged": "cast< MessageBoxText >( Parent.Find( \"MessageBoxText\" ) ).FiltersChanged();",
          "IsDisabled": false,
          "PressedImage": "art/intrface/redDot.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Filter2",
          "Position": "271, 100",
          "Size": "16, 12",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/menu.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "GameMenu",
          "Position": "712, 81",
          "Size": "19, 28",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "ShowScreen( CLIENT_SCREEN_MENU );\r\nPlaySound (\"click7+8.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/inv.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Inventory",
          "Position": "210, 92",
          "Size": "36, 15",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "ShowScreen( CLIENT_SCREEN_INVENTORY );\r\nPlaySound (\"click2.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/btn_skill.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "SwitchItems",
          "Position": "721, 6",
          "Size": "20, 20",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "CustomCall( \"ChangeSlot\" );\r\nPlaySound (\"click4.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/btn_skill.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Skills",
          "Position": "898, 16",
          "Size": "20, 20",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "ShowScreen( CLIENT_SCREEN_SKILLBOX );\r\nPlaySound (\"click4.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/map.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Map",
          "Position": "163, 91",
          "Size": "38, 17",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "ShowScreen( CLIENT_SCREEN_MINIMAP );\r\nPlaySound (\"click2.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/cha.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Character",
          "Position": "25, 90",
          "Size": "38, 17",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "ShowScreen( CLIENT_SCREEN_CHARACTER );\r\nCritterCl@ chosen = GetChosen();\r\nif( chosen !is null && chosen.ParamBase[ ST_UNSPENT_PERKS ] > 0 )\r\n    ShowScreen( CLIENT_SCREEN_PERK );\r\nPlaySound (\"click2.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/pip.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "PipBoy",
          "Position": "118, 91",
          "Size": "38, 17",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "ShowScreen( CLIENT_SCREEN_PIP_BOY );\r\nPlaySound (\"click2.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/fix.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "FixBoy",
          "Position": "72, 91",
          "Size": "38, 17",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "ShowScreen( CLIENT_SCREEN_FIX_BOY );\r\nPlaySound (\"click2.ogg\");",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Panel",
          "BackgroundImage": "art/intrface/combat.fofrm",
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "Combat",
          "Position": "891, 49",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "bool CombatActive;",
          "OnInit": "BackgroundImage.SetFirstFrame();",
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "CritterCl@ chosen = GetChosen();\r\nbool combatActive = ( chosen !is null && chosen.Param[ TO_BATTLE ] != 0 );\r\nif( combatActive != CombatActive )\r\n{\r\n    CombatActive = combatActive;\r\n    BackgroundImage.PlayAnimation( false, !combatActive );\r\n    PlaySound( \"ICIBOXX1\" );\r\n}\r\n\r\nGetChild( 0 ).SetActive( CombatActive && CustomCall( \"IsTurnBasedMyTurn\" ) == \"true\" );\r\nGetChild( 1 ).SetActive( CombatActive && IsTurnBased() );",
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Button",
              "IsDisabled": false,
              "PressedImage": "art/intrface/end_turn_button_dn.png",
              "PressedImageLayout": "None",
              "HoverImage": null,
              "HoverImageLayout": "None",
              "DisabledImage": null,
              "DisabledImageLayout": "None",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "Expanded": false,
              "Selected": false,
              "Active": false,
              "Name": "EndTurn",
              "Position": "10, 5",
              "Size": "38, 22",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": "CustomCall( \"EndTurn\" );",
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            },
            {
              "$type": "CheckBox",
              "IsChecked": null,
              "OnCheckedChanged": null,
              "IsDisabled": false,
              "PressedImage": "art/intrface/end_combat_button_dn.png",
              "PressedImageLayout": "None",
              "HoverImage": null,
              "HoverImageLayout": "None",
              "DisabledImage": null,
              "DisabledImageLayout": "None",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "Expanded": false,
              "Selected": false,
              "Active": false,
              "Name": "EndCombat",
              "Position": "10, 27",
              "Size": "38, 22",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": "CritterCl@ chosen = GetChosen();\r\nSetChecked( IsTurnBased() && chosen !is null && chosen.ParamBase[ MODE_END_COMBAT ] != 0 );",
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": "CustomCall( \"EndCombat\" );",
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "Text",
          "Text": null,
          "DynamicText": "int result = 0;\r\nCritterCl@ chosen = GetChosen();\r\nif( chosen !is null )\r\n    result = chosen.Param[ ST_CURRENT_HP ];\r\nreturn FormatXXX( result );",
          "Font": "FONT_SAND_NUM",
          "VerticalAlignment": "Center",
          "HorisontalAlignment": "Center",
          "Align": false,
          "NoColorize": false,
          "Bordered": false,
          "DrawFromBottom": false,
          "NormalColor": "COLOR_WHITE",
          "FocusedColor": "",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "HitPoints",
          "Position": "555, 11",
          "Size": "150, 50",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Text",
          "Text": "",
          "DynamicText": "int result = 0;\r\nCritterCl@ chosen = GetChosen();\r\nif( chosen !is null )\r\n    result = chosen.Param[ ST_ARMOR_CLASS ];\r\nreturn FormatXXX( result );",
          "Font": "FONT_SAND_NUM",
          "VerticalAlignment": "Center",
          "HorisontalAlignment": "Center",
          "Align": false,
          "NoColorize": false,
          "Bordered": false,
          "DrawFromBottom": false,
          "NormalColor": "COLOR_WHITE",
          "FocusedColor": "",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "ArmorClass",
          "Position": "293, 10",
          "Size": "150, 50",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        },
        {
          "$type": "Button",
          "IsDisabled": false,
          "PressedImage": "art/intrface/gunslot_down.png",
          "PressedImageLayout": "Stretch",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "MainItemPlate",
          "Position": "735, 45",
          "Size": "143, 66",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": "//if( button == MOUSE_BUTTON_LEFT || button == MOUSE_BUTTON_RIGHT )\r\n//    GetChild( 0 ).SetPosition( 0, -2 );",
          "OnMouseUp": "GetChild( 0 ).SetPosition( 0, 0 );",
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": "if( button == MOUSE_BUTTON_LEFT )\r\n    CustomCall( \"UseMainItem\" );\r\nelse if( button == MOUSE_BUTTON_RIGHT )\r\n    CustomCall( \"NextItemMode\" );\r\nelse if( button == MOUSE_BUTTON_WHEEL_UP )\r\n    CustomCall( \"NextItemMode Prev\" );\r\nelse if( button == MOUSE_BUTTON_WHEEL_DOWN )\r\n    CustomCall( \"NextItemMode\" );\r\nPlaySound (\"click12.ogg\");\r\n",
          "OnLMouseClick": "",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "ItemView",
              "UserData": null,
              "UseSorting": false,
              "OnCheckItem": "return item.CritSlot == SLOT_HAND1 ? 0 : -1;",
              "OnScrollChanged": null,
              "CellPrototype": "\"MainItemSlotCell\"",
              "GridSize": "1",
              "Columns": 0,
              "Padding": "0, 0",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "Expanded": true,
              "Selected": false,
              "Active": true,
              "Name": "MainItemSlot",
              "Position": "0, 0",
              "Size": "0, 0",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": true,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": "",
              "Children": [
                {
                  "$type": "Panel",
                  "BackgroundImage": null,
                  "BackgroundImageLayout": "Zoom",
                  "Expanded": true,
                  "Selected": false,
                  "Active": true,
                  "Name": "MainItemSlotCell",
                  "Position": "0, 0",
                  "Size": "140, 67",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": true,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": "",
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": "uint picInv = 0;\r\nif( item !is null )\r\n    picInv = ( item.PicInv != 0 ? item.PicInv : item.Proto.PicInv );\r\nSetBackgroundImage( picInv, IMAGE_LAYOUT_ZOOM );\r\nSetSize(140,67);",
                  "Children": [
                    {
                      "$type": "Text",
                      "Text": null,
                      "DynamicText": null,
                      "Font": "FONT_SPECIAL",
                      "VerticalAlignment": "Center",
                      "HorisontalAlignment": "Far",
                      "Align": false,
                      "NoColorize": false,
                      "Bordered": false,
                      "DrawFromBottom": false,
                      "NormalColor": null,
                      "FocusedColor": null,
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "DeteriorationValue",
                      "Position": "127, 7",
                      "Size": "0, 0",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": null,
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "SetText( item !is null && item.IsDeteriorable() ? item.Deterioration + \"%\" : \"\" );",
                      "Children": []
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": "art/intrface/ap_pic.png",
                      "BackgroundImageLayout": "None",
                      "Expanded": true,
                      "Selected": false,
                      "Active": true,
                      "Name": "UsePic",
                      "Position": "7, 44",
                      "Size": "17, 12",
                      "Anchor": "Bottom, Left",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": null,
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "uint usePic = 0;\r\n\r\nCritterCl@ chosen = GetChosen();\r\nuint8 mode;\r\nconst ProtoItem@ proto;\r\nuint flags;\r\nif( item !is null )\r\n{\r\n    mode = item.Mode;\r\n    @proto = item.Proto;\r\n    flags = item.Flags;\r\n}\r\nelse if( chosen !is null )\r\n{\r\n    @proto = chosen.GetSlotProto( SLOT_HAND1, mode );\r\n    flags = proto.Flags;\r\n}\r\n\r\nif( item !is null || chosen !is null )\r\n{\r\n    int use = _WeaponModeUse( mode );\r\n    if( proto.Type == ITEM_TYPE_WEAPON )\r\n    {\r\n        if( use == USE_RELOAD )\r\n            usePic = GetStrHash( \"art\\\\intrface\\\\reload.frm\" );\r\n        else if( use == USE_USE )\r\n            usePic = GetStrHash( \"art\\\\intrface\\\\useon.frm\" );\r\n        else if( use < MAX_USES )\r\n            usePic = _WeaponPicUse( proto, use );\r\n    }\r\n    if( usePic == 0 && FLAG( item.Flags, ITEM_CAN_USE_ON_SMTH ) )\r\n        usePic = GetStrHash( \"art\\\\intrface\\\\useon.frm\" );\r\n    if( usePic == 0 && FLAG( item.Flags, ITEM_CAN_USE ) )\r\n        usePic = GetStrHash( \"art\\\\intrface\\\\uset.frm\" );\r\n}\r\n//cast<UseLabel> (Find(\"UseLabel\")).SetText(usePic);\r\nBackgroundImage.Load( usePic );\r\n//SetPosition( 180 - BackgroundImage.Width, PosY );",
                      "Children": [
                        {
                          "$type": "Text",
                          "Text": null,
                          "DynamicText": null,
                          "Font": null,
                          "VerticalAlignment": "Near",
                          "HorisontalAlignment": "Near",
                          "Align": false,
                          "NoColorize": false,
                          "Bordered": false,
                          "DrawFromBottom": false,
                          "NormalColor": null,
                          "FocusedColor": null,
                          "Expanded": false,
                          "Selected": false,
                          "Active": true,
                          "Name": "UseLabel",
                          "Position": "0, -16",
                          "Size": "0, 0",
                          "Anchor": "None",
                          "Dock": "None",
                          "IsDraggable": false,
                          "IsNotHittable": false,
                          "CheckTransparentOnHit": false,
                          "GlobalScope": null,
                          "ClassFields": null,
                          "OnInit": null,
                          "OnShow": null,
                          "OnHide": null,
                          "OnAppear": null,
                          "OnDisappear": null,
                          "OnDraw": null,
                          "OnMove": null,
                          "OnMouseDown": null,
                          "OnMouseUp": null,
                          "OnMousePressed": null,
                          "OnLMousePressed": null,
                          "OnRMousePressed": null,
                          "OnMouseClick": null,
                          "OnLMouseClick": null,
                          "OnRMouseClick": null,
                          "OnMouseMove": null,
                          "OnGlobalMouseDown": null,
                          "OnGlobalMouseUp": null,
                          "OnGlobalMousePressed": null,
                          "OnGlobalMouseClick": null,
                          "OnGlobalMouseMove": null,
                          "OnInput": null,
                          "OnGlobalInput": null,
                          "OnActiveChanged": null,
                          "OnFocusChanged": null,
                          "OnHoverChanged": null,
                          "OnDragChanged": null,
                          "OnResizeGrid": null,
                          "OnDrawItem": null,
                          "Children": []
                        }
                      ]
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": "",
                      "BackgroundImageLayout": "None",
                      "Expanded": true,
                      "Selected": false,
                      "Active": true,
                      "Name": "ApCost",
                      "Position": "28, -106",
                      "Size": "0, 0",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": "import uint GetItemUseApCost( CritterCl& cr, ItemCl& item, uint8 mode ) from \"parameters\";\r\nimport uint GetProtoItemUseApCost( CritterCl& cr, ProtoItem& proto, uint8 mode ) from \"parameters\";",
                      "ClassFields": "",
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "uint apCost = 0;\r\nif( item !is null && item.Accessory == ACCESSORY_CRITTER )\r\n{\r\n    apCost = GetItemUseApCost( GetCritter( item.CritId ), item, item.Mode );\r\n}\r\nelse if( item is null )\r\n{\r\n    CritterCl@ chosen = GetChosen();\r\n    if( chosen !is null )\r\n    {\r\n        uint8 mode = 0;\r\n        ProtoItem@ proto = chosen.GetSlotProto( SLOT_HAND1, mode );\r\n        apCost = GetProtoItemUseApCost( chosen, proto, mode );\r\n    }\r\n}\r\n\r\nSetActive( apCost > 0 );\r\nif( apCost > 0 )\r\n    FindText( \"ApCostValue\" ).SetText( \"\" + apCost );",
                      "Children": [
                        {
                          "$type": "Text",
                          "Text": null,
                          "DynamicText": null,
                          "Font": "FONT_FAT",
                          "VerticalAlignment": "Near",
                          "HorisontalAlignment": "Near",
                          "Align": false,
                          "NoColorize": false,
                          "Bordered": true,
                          "DrawFromBottom": false,
                          "NormalColor": "COLOR_WHITE",
                          "FocusedColor": null,
                          "Expanded": false,
                          "Selected": false,
                          "Active": true,
                          "Name": "ApCostValue",
                          "Position": "-22, 114",
                          "Size": "0, 0",
                          "Anchor": "None",
                          "Dock": "None",
                          "IsDraggable": false,
                          "IsNotHittable": false,
                          "CheckTransparentOnHit": false,
                          "GlobalScope": null,
                          "ClassFields": null,
                          "OnInit": null,
                          "OnShow": null,
                          "OnHide": null,
                          "OnAppear": null,
                          "OnDisappear": null,
                          "OnDraw": null,
                          "OnMove": null,
                          "OnMouseDown": null,
                          "OnMouseUp": null,
                          "OnMousePressed": null,
                          "OnLMousePressed": null,
                          "OnRMousePressed": null,
                          "OnMouseClick": null,
                          "OnLMouseClick": null,
                          "OnRMouseClick": null,
                          "OnMouseMove": null,
                          "OnGlobalMouseDown": null,
                          "OnGlobalMouseUp": null,
                          "OnGlobalMousePressed": null,
                          "OnGlobalMouseClick": null,
                          "OnGlobalMouseMove": null,
                          "OnInput": null,
                          "OnGlobalInput": null,
                          "OnActiveChanged": null,
                          "OnFocusChanged": null,
                          "OnHoverChanged": null,
                          "OnDragChanged": null,
                          "OnResizeGrid": null,
                          "OnDrawItem": "",
                          "Children": []
                        }
                      ]
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": "art/intrface/aim_pic.png",
                      "BackgroundImageLayout": "None",
                      "Expanded": false,
                      "Selected": false,
                      "Active": true,
                      "Name": "AimPic",
                      "Position": "114, 40",
                      "Size": "18, 18",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": null,
                      "OnInit": null,
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": null,
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "CritterCl@ chosen = GetChosen();\r\nuint8 mode = 0;\r\nif( item !is null )\r\n    mode = item.Mode;\r\nelse if( chosen !is null )\r\n    chosen.GetSlotProto( SLOT_HAND1, mode );\r\n\r\nBackgroundImage.Hidden = ( _WeaponModeAim( mode ) == HIT_LOCATION_NONE );",
                      "Children": []
                    },
                    {
                      "$type": "Panel",
                      "BackgroundImage": null,
                      "BackgroundImageLayout": "None",
                      "Expanded": true,
                      "Selected": false,
                      "Active": true,
                      "Name": "AmmoBar",
                      "Position": "3, -9",
                      "Size": "140, 8",
                      "Anchor": "None",
                      "Dock": "None",
                      "IsDraggable": false,
                      "IsNotHittable": true,
                      "CheckTransparentOnHit": false,
                      "GlobalScope": null,
                      "ClassFields": "uint sprite      = 0;\r\nuint spriteWidth = 0;",
                      "OnInit": "sprite      = LoadSprite( \"ap_bar_small.png\", PT_ART_INTRFACE );\r\nspriteWidth = GetSpriteWidth(sprite, -1);",
                      "OnShow": null,
                      "OnHide": null,
                      "OnAppear": null,
                      "OnDisappear": null,
                      "OnDraw": "",
                      "OnMove": null,
                      "OnMouseDown": null,
                      "OnMouseUp": null,
                      "OnMousePressed": null,
                      "OnLMousePressed": null,
                      "OnRMousePressed": null,
                      "OnMouseClick": null,
                      "OnLMouseClick": null,
                      "OnRMouseClick": null,
                      "OnMouseMove": null,
                      "OnGlobalMouseDown": null,
                      "OnGlobalMouseUp": null,
                      "OnGlobalMousePressed": null,
                      "OnGlobalMouseClick": null,
                      "OnGlobalMouseMove": null,
                      "OnInput": null,
                      "OnGlobalInput": null,
                      "OnActiveChanged": null,
                      "OnFocusChanged": null,
                      "OnHoverChanged": null,
                      "OnDragChanged": null,
                      "OnResizeGrid": null,
                      "OnDrawItem": "uint max  = 0;\r\nuint curr = 0;\r\nif( item !is null )\r\n{\r\n    if( item.GetType() == ITEM_TYPE_WEAPON && item.Proto.Weapon_MaxAmmoCount > 0 )\r\n    {\r\n        max  = item.Proto.Weapon_MaxAmmoCount;\r\n        curr = item.AmmoCount;\r\n    }\r\n    else\r\n    {\r\n        max  = item.GetCount();\r\n        curr = item.GetCount() - 1;\r\n    }\r\n    if(max > 0 && curr <= max && curr >= 0){\r\n        float red        = 144;\r\n        float green      = 54;\r\n        float blue       = 38;\r\n        float alpha      = 255;\r\n        float brightness = 0.8;\r\n        //float brightness = 1; @@todo переделать все нафиг\r\n        //if( curr == max ){\r\n            uint barWidth = curr == max ? get_Width() : floor( get_Width() * (curr) / max );\r\n            DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,12,0,0,COLOR_ARGB(alpha,floor(red*brightness),floor(green*brightness),floor(blue*brightness)));\r\n        /*} else {\r\n            uint barWidth = curr == max ? get_Width() : floor( get_Width() * (curr * 1.0) / max );\r\n            float dred    = red  - ( (red-green) * (curr * 1.0)/max);\r\n            Message(\"CYRR\"+curr+\"/\"+max+\" \"+red);\r\n            DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,12,0,0,COLOR_ARGB(alpha,floor(dred*brightness),floor(green*brightness),floor(blue*brightness)));\r\n        }*/\r\n    }\r\n}",
                      "Children": [
                        {
                          "$type": "Text",
                          "Text": null,
                          "DynamicText": null,
                          "Font": "FONT_FALLOUT",
                          "VerticalAlignment": "Center",
                          "HorisontalAlignment": "Center",
                          "Align": false,
                          "NoColorize": false,
                          "Bordered": true,
                          "DrawFromBottom": false,
                          "NormalColor": "COLOR_WHITE",
                          "FocusedColor": null,
                          "Expanded": false,
                          "Selected": false,
                          "Active": true,
                          "Name": "AmmoCount",
                          "Position": "36, -2",
                          "Size": "50, 18",
                          "Anchor": "None",
                          "Dock": "None",
                          "IsDraggable": false,
                          "IsNotHittable": true,
                          "CheckTransparentOnHit": false,
                          "GlobalScope": null,
                          "ClassFields": null,
                          "OnInit": null,
                          "OnShow": null,
                          "OnHide": null,
                          "OnAppear": null,
                          "OnDisappear": null,
                          "OnDraw": null,
                          "OnMove": null,
                          "OnMouseDown": null,
                          "OnMouseUp": null,
                          "OnMousePressed": null,
                          "OnLMousePressed": null,
                          "OnRMousePressed": null,
                          "OnMouseClick": null,
                          "OnLMouseClick": null,
                          "OnRMouseClick": null,
                          "OnMouseMove": null,
                          "OnGlobalMouseDown": null,
                          "OnGlobalMouseUp": null,
                          "OnGlobalMousePressed": null,
                          "OnGlobalMouseClick": null,
                          "OnGlobalMouseMove": null,
                          "OnInput": null,
                          "OnGlobalInput": null,
                          "OnActiveChanged": null,
                          "OnFocusChanged": null,
                          "OnHoverChanged": null,
                          "OnDragChanged": null,
                          "OnResizeGrid": null,
                          "OnDrawItem": "if( item !is null ){\r\n    if(  item.GetType() == ITEM_TYPE_WEAPON ){\r\n        if( item.Proto.Weapon_MaxAmmoCount > 0 ){\r\n            SetText( item.AmmoCount+\"/\"+item.Proto.Weapon_MaxAmmoCount );\r\n        }else{\r\n            SetText( 1+\"/\"+item.GetCount() );\r\n        }\r\n    }else{\r\n        SetText( 1+\"/\"+item.GetCount() );\r\n    }\r\n}else{\r\n    SetText( \"\" );\r\n}",
                          "Children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "$type": "Panel",
          "BackgroundImage": "",
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "BreakTime",
          "Position": "681, 30",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "",
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "CritterCl@ chosen = GetChosen();\r\nGetChild( 0 ).SetActive( chosen !is null && chosen.IsBusy() );",
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": "",
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": "",
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": "art/intrface/test5.png",
              "BackgroundImageLayout": "None",
              "Expanded": false,
              "Selected": false,
              "Active": true,
              "Name": "BreakTimeLed",
              "Position": "-54, 27",
              "Size": "75, 75",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": "bool IsChecked = false;",
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": "",
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "Panel",
          "BackgroundImage": "",
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "ActionBar",
          "Position": "324, 83",
          "Size": "304, 26",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": true,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "uint sprite       = 0;\r\nuint spriteWidth  = 0;\r\nuint spriteHeight = 0;",
          "OnInit": "sprite       = LoadSprite( \"ap_bar_seg.png\", PT_ART_INTRFACE );\r\nspriteWidth  = GetSpriteWidth(sprite, -1);\r\nspriteHeight = GetSpriteHeight(sprite, -1);",
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "CritterCl@ chosen = GetChosen();\r\nif(valid(chosen))\r\n{\r\n    int ap           = ( chosen !is null ? CLAMP(chosen.Param[ ST_CURRENT_AP ],-100,100) : 0 );\r\n    uint barWidth    = floor(get_Width() * ABS( ap ) / 100);\r\n    uint colorOffset = (ap >= 0) ? floor((255 * ABS(ap)) / 100) : 0;\r\n    DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,spriteHeight,0,0,COLOR_ARGB(120, 255 - colorOffset, colorOffset, 0));\r\n}",
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Text",
              "Text": null,
              "DynamicText": "CritterCl@ chosen = GetChosen();\r\n\r\nif(chosen is null) return \"0\";\r\n\r\n//uint colorOffset = (chosen.Param[ ST_CURRENT_AP ] >= 0) ? floor((255 * ABS(chosen.Param[ ST_CURRENT_AP ])) / 100) : 0;\r\n//SetTextColor( COLOR_ARGB(255, 255 - colorOffset, colorOffset, 0) );\r\nreturn \"\" + chosen.Param[ ST_CURRENT_AP ];",
              "Font": "FONT_FAT",
              "VerticalAlignment": "Center",
              "HorisontalAlignment": "Center",
              "Align": false,
              "NoColorize": false,
              "Bordered": true,
              "DrawFromBottom": false,
              "NormalColor": "COLOR_WHITE",
              "FocusedColor": null,
              "Expanded": false,
              "Selected": false,
              "Active": true,
              "Name": "ActionBarValue",
              "Position": "320, 0",
              "Size": "40, 25",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": true,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": null,
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": null,
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": []
            }
          ]
        },
        {
          "$type": "Panel",
          "BackgroundImage": "art/intrface/bar-4b.png",
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "HungerBar",
          "Position": "443, 50",
          "Size": "120, 17",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "",
          "OnInit": "",
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "",
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "Expanded": true,
              "Selected": false,
              "Active": true,
              "Name": "HungerFill",
              "Position": "8, 1",
              "Size": "102, 15",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": "uint sprite;\r\nuint spriteWidth;\r\nuint red   = 182;\r\nuint green = 198;\r\nuint blue  = 65;",
              "OnInit": "sprite      = LoadSprite( \"ap_bar_small.png\", PT_ART_INTRFACE );\r\nspriteWidth = GetSpriteWidth(sprite, -1) ;",
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": "CritterCl@ chosen = GetChosen();\r\nif(valid(chosen))\r\n{\r\n    uint barWidth    = get_Width() - get_Width() * ABS( chosen.Param[ST_HUNGER] ) / 2500; // Hunger counter is inverted\r\n    //uint colorOffset = 255 * ABS( chosen.Param[ST_HUNGER] ) / 2500;\r\n    //DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,15,0,0,COLOR_ARGB(200,255-colorOffset,colorOffset,0));\r\n    float brightness = 0.7;\r\n    DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,15,0,0,COLOR_ARGB(255,floor(red*brightness),floor(green*brightness),floor(blue*brightness)));\r\n}",
              "OnMove": "",
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": [
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/icon_hunger.png",
                  "BackgroundImageLayout": "None",
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "HungerIcon",
                  "Position": "85, -1",
                  "Size": "17, 17",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": false,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                }
              ]
            }
          ]
        },
        {
          "$type": "Panel",
          "BackgroundImage": "art/intrface/bar-4b.png",
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "ThirstBar",
          "Position": "443, 29",
          "Size": "120, 17",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "Expanded": true,
              "Selected": false,
              "Active": true,
              "Name": "ThirstFill",
              "Position": "9, 1",
              "Size": "102, 15",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": "uint sprite;\r\nuint spriteWidth;\r\nuint red   = 65;\r\nuint green = 113;\r\nuint blue  = 198;",
              "OnInit": "sprite      = LoadSprite( \"ap_bar_small.png\", PT_ART_INTRFACE );\r\nspriteWidth = GetSpriteWidth(sprite, -1) ;",
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": "CritterCl@ chosen = GetChosen();\r\nif(valid(chosen))\r\n{\r\n    uint barWidth    = get_Width() - get_Width() * ABS( chosen.Param[ST_THIRST] ) / 2500; // Thirst counter is inverted\r\n    //uint colorOffset = 255 * ABS( chosen.Param[ST_THIRST] ) / 2500;\r\n    //DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,15,0,0,COLOR_ARGB(200,255-colorOffset,colorOffset,0));\r\n    float brightness = 0.7;\r\n    DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,15,0,0,COLOR_ARGB(255,floor(red*brightness),floor(green*brightness),floor(blue*brightness)));\r\n}",
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": [
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/icon_thirst.png",
                  "BackgroundImageLayout": "None",
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "ThirstIcon",
                  "Position": "89, 1",
                  "Size": "9, 13",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": false,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                }
              ]
            }
          ]
        },
        {
          "$type": "Panel",
          "BackgroundImage": "art/intrface/bar-4b.png",
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "FatigueBar",
          "Position": "443, 8",
          "Size": "120, 17",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Panel",
              "BackgroundImage": null,
              "BackgroundImageLayout": "None",
              "Expanded": true,
              "Selected": false,
              "Active": true,
              "Name": "FatigueFill",
              "Position": "9, 1",
              "Size": "102, 15",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": "",
              "ClassFields": "uint sprite;\r\nuint spriteWidth;\r\nuint red    = 198;\r\nuint green  = 65;\r\nuint blue   = 65;\r\n",
              "OnInit": "sprite      = LoadSprite( \"ap_bar_small.png\", PT_ART_INTRFACE );\r\nspriteWidth = GetSpriteWidth(sprite, -1) ;\r\n",
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": "",
              "OnDraw": "CritterCl@ chosen = GetChosen();\r\nif(valid(chosen))\r\n{\r\n    uint barWidth    = get_Width() * ABS( chosen.Param[ST_FATIGUE] ) / 2500;\r\n    //uint colorOffset = 255 * ABS( chosen.Param[ST_FATIGUE] ) / 2500;\r\n    //DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,15,0,0,COLOR_ARGB(200,255-colorOffset,colorOffset,0));\r\n    float brightness = 0.7;\r\n    DrawSpritePattern(sprite,-1,AbsolutePosX,AbsolutePosY,barWidth,15,0,0,COLOR_ARGB(255,floor(red*brightness),floor(green*brightness),floor(blue*brightness)));\r\n}",
              "OnMove": null,
              "OnMouseDown": null,
              "OnMouseUp": null,
              "OnMousePressed": null,
              "OnLMousePressed": null,
              "OnRMousePressed": null,
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": null,
              "OnDrawItem": null,
              "Children": [
                {
                  "$type": "Panel",
                  "BackgroundImage": "art/intrface/icon_fatigue.png",
                  "BackgroundImageLayout": "None",
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "FatigueIcon",
                  "Position": "87, 0",
                  "Size": "15, 15",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": false,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                }
              ]
            }
          ]
        },
        {
          "$type": "CheckBox",
          "IsChecked": null,
          "OnCheckedChanged": "if(IsChecked){\r\n    Parent.Find(\"HungerBar\").SetActive(false);\r\n    Parent.Find(\"ThirstBar\").SetActive(false);\r\n    Parent.Find(\"FatigueBar\").SetActive(false);\r\n}else{\r\n    Parent.Find(\"HungerBar\").SetActive(true);\r\n    Parent.Find(\"ThirstBar\").SetActive(true);\r\n    Parent.Find(\"FatigueBar\").SetActive(true);\r\n}",
          "IsDisabled": false,
          "PressedImage": null,
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "HideBars",
          "Position": "270, 88",
          "Size": "20, 12",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        }
      ]
    },
    {
      "$type": "Panel",
      "BackgroundImage": "art/intrface/quickbar_vertical.png",
      "BackgroundImageLayout": "None",
      "Expanded": true,
      "Selected": false,
      "Active": true,
      "Name": "Quickbar",
      "Position": "119, 431",
      "Size": "50, 387",
      "Anchor": "None",
      "Dock": "None",
      "IsDraggable": false,
      "IsNotHittable": false,
      "CheckTransparentOnHit": false,
      "GlobalScope": "import uint quickItemAddCurrent(uint quick_slot) from \"client_quickbar\";\r\nimport void quickItemUse(uint quick_slot, bool forced = false) from \"client_quickbar\";\r\nimport ItemCl@ quickItem(uint quick_slot) from \"client_quickbar\";",
      "ClassFields": "bool isHold = false;\r\nint holdX   = 0;\r\nint holdY   = 0;",
      "OnInit": "SetPosition(5, 5);\r\n// @@todo сохранение позиции и поворота quickbar между сессиями",
      "OnShow": null,
      "OnHide": null,
      "OnAppear": null,
      "OnDisappear": null,
      "OnDraw": "if(get_Width() > 100){\r\n    SetBackgroundImage(\"art/intrface/quickbar.png\");\r\n}else{\r\n    SetBackgroundImage(\"art/intrface/quickbar_vertical.png\");\r\n}",
      "OnMove": null,
      "OnMouseDown": "if(button == 1){\r\n    isHold = true;\r\n    holdX  = __MouseX;\r\n    holdY  = __MouseY;\r\n}",
      "OnMouseUp": "if(button == 1) isHold = false;",
      "OnMousePressed": "",
      "OnLMousePressed": "",
      "OnRMousePressed": "",
      "OnMouseClick": null,
      "OnLMouseClick": null,
      "OnRMouseClick": null,
      "OnMouseMove": "",
      "OnGlobalMouseDown": null,
      "OnGlobalMouseUp": null,
      "OnGlobalMousePressed": null,
      "OnGlobalMouseClick": null,
      "OnGlobalMouseMove": "if(isHold){\r\n    SetPosition(AbsolutePosX + (__MouseX - holdX),AbsolutePosY + (__MouseY - holdY) );\r\n    holdX  = __MouseX;\r\n    holdY  = __MouseY;\r\n}",
      "OnInput": null,
      "OnGlobalInput": null,
      "OnActiveChanged": null,
      "OnFocusChanged": null,
      "OnHoverChanged": null,
      "OnDragChanged": null,
      "OnResizeGrid": null,
      "OnDrawItem": null,
      "Children": [
        {
          "$type": "Grid",
          "CellPrototype": "\"QuickbarItem\"",
          "GridSize": "11",
          "Columns": 0,
          "Padding": "4, 4",
          "BackgroundImage": null,
          "BackgroundImageLayout": "None",
          "Expanded": true,
          "Selected": false,
          "Active": true,
          "Name": "QuickbarGrid",
          "Position": "9, 5",
          "Size": "0, 0",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": "uint scroll_position = 0;",
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": "",
          "OnMove": null,
          "OnMouseDown": "",
          "OnMouseUp": null,
          "OnMousePressed": "",
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": [
            {
              "$type": "Button",
              "IsDisabled": false,
              "PressedImage": null,
              "PressedImageLayout": "None",
              "HoverImage": null,
              "HoverImageLayout": "None",
              "DisabledImage": null,
              "DisabledImageLayout": "None",
              "BackgroundImage": "",
              "BackgroundImageLayout": "Zoom",
              "Expanded": true,
              "Selected": true,
              "Active": true,
              "Name": "QuickbarItem",
              "Position": "-2, 0",
              "Size": "30, 30",
              "Anchor": "None",
              "Dock": "None",
              "IsDraggable": false,
              "IsNotHittable": false,
              "CheckTransparentOnHit": false,
              "GlobalScope": null,
              "ClassFields": "uint slot_id = 0;\r\nuint item_id = 0;\r\nuint id_offset(){\r\n    return cast< QuickbarGrid >(Parent).scroll_position;\r\n}",
              "OnInit": null,
              "OnShow": null,
              "OnHide": null,
              "OnAppear": null,
              "OnDisappear": null,
              "OnDraw": "ItemCl@ item = quickItem(slot_id + id_offset());\r\nuint icon = item !is null ? ( item.PicInv != 0 ? item.PicInv : item.Proto.PicInv ) : 0;\r\nSetBackgroundImage(icon > 0 ? icon : -1,IMAGE_LAYOUT_ZOOM);\r\n\r\nQuickbarLabel@ label = cast<QuickbarLabel> (Find(\"QuickbarLabel\"));\r\nif(label !is null){\r\n    if(item !is null){\r\n        int count = item.GetCount();\r\n        label.SetText(count>1?\"\"+count:\"\");\r\n    }else{\r\n        label.SetText(\"\");\r\n    }\r\n}",
              "OnMove": null,
              "OnMouseDown": "if( button == MOUSE_BUTTON_WHEEL_UP || button == MOUSE_BUTTON_WHEEL_DOWN )\r\n{\r\n    QuickbarGrid@ parent = cast <QuickbarGrid>(Parent);\r\n    if(button == MOUSE_BUTTON_WHEEL_UP){\r\n        if(parent.scroll_position > 0){\r\n            parent.scroll_position -= 1;\r\n        }\r\n    }else{\r\n        if(parent.scroll_position < 1000){\r\n            parent.scroll_position += 1;\r\n        }\r\n    }\r\n}",
              "OnMouseUp": null,
              "OnMousePressed": "switch(button){\r\n  case 0: // Left click \r\n    if(IsCtrlDown()){\r\n        quickItemUse(slot_id + id_offset(),true);\r\n    }else{\r\n        quickItemUse(slot_id + id_offset());\r\n    }\r\n    break;\r\n  case 1: // Right click\r\n    quickItemAddCurrent(slot_id + id_offset());\r\n    break;\r\n  case 2: // Middle mouse button\r\n    quickItemUse(slot_id + id_offset(),true);\r\n    break;\r\n}\r\nPlaySound (\"click2.ogg\");",
              "OnLMousePressed": "",
              "OnRMousePressed": "",
              "OnMouseClick": null,
              "OnLMouseClick": null,
              "OnRMouseClick": null,
              "OnMouseMove": null,
              "OnGlobalMouseDown": null,
              "OnGlobalMouseUp": null,
              "OnGlobalMousePressed": null,
              "OnGlobalMouseClick": null,
              "OnGlobalMouseMove": null,
              "OnInput": null,
              "OnGlobalInput": null,
              "OnActiveChanged": null,
              "OnFocusChanged": null,
              "OnHoverChanged": null,
              "OnDragChanged": null,
              "OnResizeGrid": "slot_id = uint(cellIndex);",
              "OnDrawItem": "",
              "Children": [
                {
                  "$type": "Text",
                  "Text": null,
                  "DynamicText": null,
                  "Font": "FONT_FALLOUT",
                  "VerticalAlignment": "Far",
                  "HorisontalAlignment": "Near",
                  "Align": false,
                  "NoColorize": false,
                  "Bordered": true,
                  "DrawFromBottom": false,
                  "NormalColor": "COLOR_ARGB(200,255,255,255)",
                  "FocusedColor": null,
                  "Expanded": false,
                  "Selected": false,
                  "Active": true,
                  "Name": "QuickbarLabel",
                  "Position": "2, 13",
                  "Size": "32, 18",
                  "Anchor": "None",
                  "Dock": "None",
                  "IsDraggable": false,
                  "IsNotHittable": true,
                  "CheckTransparentOnHit": false,
                  "GlobalScope": null,
                  "ClassFields": null,
                  "OnInit": null,
                  "OnShow": null,
                  "OnHide": null,
                  "OnAppear": null,
                  "OnDisappear": null,
                  "OnDraw": null,
                  "OnMove": null,
                  "OnMouseDown": null,
                  "OnMouseUp": null,
                  "OnMousePressed": null,
                  "OnLMousePressed": null,
                  "OnRMousePressed": null,
                  "OnMouseClick": null,
                  "OnLMouseClick": null,
                  "OnRMouseClick": null,
                  "OnMouseMove": null,
                  "OnGlobalMouseDown": null,
                  "OnGlobalMouseUp": null,
                  "OnGlobalMousePressed": null,
                  "OnGlobalMouseClick": null,
                  "OnGlobalMouseMove": null,
                  "OnInput": null,
                  "OnGlobalInput": null,
                  "OnActiveChanged": null,
                  "OnFocusChanged": null,
                  "OnHoverChanged": null,
                  "OnDragChanged": null,
                  "OnResizeGrid": null,
                  "OnDrawItem": null,
                  "Children": []
                }
              ]
            }
          ]
        },
        {
          "$type": "CheckBox",
          "IsChecked": null,
          "OnCheckedChanged": "GUIGrid@ QuickbarGrid = cast< GUIGrid > (Parent.Find(\"QuickbarGrid\"));\r\n\r\nif(IsChecked){\r\n    Parent.SetSize(387, 50);\r\n    QuickbarGrid.SetColumns(11);\r\n}else{\r\n    Parent.SetSize(50, 387);\r\n    QuickbarGrid.SetColumns(1);\r\n}\r\nQuickbarGrid.ResizeGrid(11);",
          "IsDisabled": false,
          "PressedImage": "art/intrface/greenDot.png",
          "PressedImageLayout": "None",
          "HoverImage": null,
          "HoverImageLayout": "None",
          "DisabledImage": null,
          "DisabledImageLayout": "None",
          "BackgroundImage": "art/intrface/redDot.png",
          "BackgroundImageLayout": "None",
          "Expanded": false,
          "Selected": false,
          "Active": true,
          "Name": "QuickbarRotate",
          "Position": "0, 0",
          "Size": "16, 12",
          "Anchor": "None",
          "Dock": "None",
          "IsDraggable": false,
          "IsNotHittable": false,
          "CheckTransparentOnHit": false,
          "GlobalScope": null,
          "ClassFields": null,
          "OnInit": null,
          "OnShow": null,
          "OnHide": null,
          "OnAppear": null,
          "OnDisappear": null,
          "OnDraw": null,
          "OnMove": null,
          "OnMouseDown": null,
          "OnMouseUp": null,
          "OnMousePressed": null,
          "OnLMousePressed": null,
          "OnRMousePressed": null,
          "OnMouseClick": null,
          "OnLMouseClick": null,
          "OnRMouseClick": null,
          "OnMouseMove": null,
          "OnGlobalMouseDown": null,
          "OnGlobalMouseUp": null,
          "OnGlobalMousePressed": null,
          "OnGlobalMouseClick": null,
          "OnGlobalMouseMove": null,
          "OnInput": null,
          "OnGlobalInput": null,
          "OnActiveChanged": null,
          "OnFocusChanged": null,
          "OnHoverChanged": null,
          "OnDragChanged": null,
          "OnResizeGrid": null,
          "OnDrawItem": null,
          "Children": []
        }
      ]
    }
  ]
}